<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speedy - Bikes</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1D4ED8',
                        secondary: '#2563EB',
                        accent: '#FBBF24',
                    },
                }
            }
        }
    </script>

    <style>
        .swal2-popup {
            border-radius: 20px !important;
        }

        .swal-mobile-fix {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        .swal2-container {
            padding: 10px !important;
        }

        .swal2-popup {
            margin: auto !important;
        }

        @media (max-width: 768px) {
            .swal2-popup {
                width: 90% !important;
                max-width: 400px !important;
            }
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body class="bg-gray-100 min-h-screen flex justify-center items-start p-4">

    <!-- Mobile App Container -->
    <div class="bg-white w-full max-w-sm rounded-3xl shadow-xl overflow-hidden flex flex-col min-h-[80vh]">

        <!-- Header -->
        <header class="bg-purple-400 text-white p-6 text-center rounded-b-3xl">
            <h1 class="text-2xl font-bold mb-1"><span>My Bikes</span></h1>
            <p class="text-sm opacity-90"span>Manage your bikes here.</span></p>

            <p class="text-sm-600 mb-6" 
                th:if="${shop != null}">
                <span class="font-bold" th:text="${shop.name}">Shop Name</span> - 
                <span class="italic" th:text="${shop.location}">Location</span>
            </p>
        </header>

        <main class="flex-1 p-6 space-y-6 overflow-auto">
            
            <section class="bg-gray-100 p-6 rounded-2xl shadow-md max-w-md mx-auto border border-gray-200" th:if="${shop==null}">
                <h2 class="text-xl font-semibold text-gray-800 mb-3">No Shop Found</h2>
                
                <p class="text-gray-600 mb-6" 
                th:if="${shop != null}">
                    <span class="font-bold" th:text="${shop.name}">Shop Not Found</span> - 
                    <span class="italic" th:text="${shop.location}">Please create a shop before adding Bikes.</span>
                </p>
                <p class="text-gray-600 mb-6" th:if="${shop == null}">
                    Start by updating your shop details
                </p>

                <section class="text-center">
                    <button 
                        id="getStarted" 
                        th:attr="data-shop-name=${shop?.name}, data-shop-location=${shop?.location}"
                        onclick="const btn = document.getElementById('getStarted'); openShopDialog(btn.dataset.shopName, btn.dataset.shopLocation);"
                        class="bg-orange-500 text-white font-semibold py-3 px-8 w-full rounded-2xl shadow hover:bg-orange-600 transition-colors duration-300 text-lg" 
                    > 
                        Update Shop Details 
                    </button>
                </section>
            </section>

            <div th:if="${bikes != null}" class="space-y-6">
                <section class="bg-gray-100 p-6 rounded-2xl shadow-md max-w-md mx-auto border border-gray-200">
                    <h2 class="text-xl font-semibold text-gray-800 mb-3">My Bikes</h2>

                    <p class="text-gray-600 mb-6">
                        <span class="italic">You have </span> - 
                        <span class="font-bold">[[${bikes.size()}]] bikes</span>
                    </p>

                    <p class="text-gray-600 mb-6">
                        [[${bikes.size() == 0} ? 'Register Your First Bike' : 'Manage Available Bikes']]
                    </p>

                    
                    <section class="text-center">
                        <button 
                            id="manageBikes" 
                            class="bg-green-500 text-white font-semibold py-3 px-8 w-full rounded-2xl shadow hover:bg-green-600 transition-colors duration-300 text-lg"
                        >
                            Register New Bike
                        </button>
                    </section>

                </section>

                <section class="bg-gray-100 p-6 rounded-2xl shadow-md max-w-md mx-auto border border-gray-200">
                    <h2 class="text-xl font-semibold text-gray-800 mb-3">Registered Bikes</h2>

                    <!-- Empty State -->
                    <div th:if="${bikes.size() == 0}" class="text-gray-600 italic text-center py-4">
                        Please Register bike to Get Started.
                    </div>

                    <!-- Bike List -->
                    <div th:each="bike : ${bikes}" th:if="${bikes.size() > 0}" class="flex items-center space-x-4 mb-6 bike-item">

                        <!-- Image (clickable) -->
                        <img th:src="${bike.getPictureURL()}" 
                            alt="Bike Image" 
                            class="w-24 h-24 object-cover rounded-xl shadow cursor-pointer"
                            th:attr="data-code=${bike.getCode()}, data-rpm=${bike.getRpm()}">

                        <!-- Details -->
                        <div class="text-gray-700 flex-1">
                            <p class="text-1xl font-semibold">[[${bike.getCode()}]]</p>
                            <p><span class="font-semibold italic">RPM</span><span> - KSH[[${T(java.lang.Math).round(bike.getRpm())}]]</span></p>
                            <p>
                                <span th:text="${bike.getAvailabilityStatus()} ? 'Available' : 'Unavailable'"
                                    th:classappend="${bike.getAvailabilityStatus()} ? 'text-green-600' : 'text-red-600'">
                                </span>
                            </p>
                        </div>

                        <!-- Delete Button -->
                        <button 
                            class="text-red-600 hover:text-red-800 p-1"
                            style="font-size: 0.75rem;"
                            onclick="confirmDelete(this)">
                            <!-- Smaller Trash Icon -->
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5-4h4m-4 0a2 2 0 00-2 2v0h8v0a2 2 0 00-2-2m-4 0V3m0 4v12" />
                            </svg>
                        </button>
                    </div>

                    <script>
                        
                    </script>
                </section>
            </div>
        </main>
        <footer class="text-center p-4 text-sm text-gray-400">
            &copy; 2025 Speedy Inc.
        </footer>
    </div>
    <script src="/bike-service.js"></script>
    <script src="/shop-service.js"></script>
</body>
</html>
